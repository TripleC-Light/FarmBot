<!DOCTYPE html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<html lang="zh-Hant">
<head>
	<meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Serial Update Test</title>
	<style>
		@import url(https://fonts.googleapis.com/earlyaccess/notosanstc.css);

		.mainCSS{
		    font-family: 'Noto Sans TC', sans-serif;
		}
		.tableCSS {
		    border: 2px solid #000000;
		    box-shadow: 5px 5px 5px rgba(50%,50%,50%,0.8);
			border-radius: 30px;
		}
		.trCSS, .tdCSS {
		    border: 1px solid #000000;
		}
		.settingBtn {
		    font-size: 16px;
		    color: #00F;
		    text-align: center;
		    vertical-align: middle;
		    line-height: -2px;
		    height: 25px;
		    width: 60px;
		    padding: 0px 5px;
		    border: solid 1px #00F;
		    border-radius: 3px;
		    background: #EEEEFF;
		    text-decoration: none;
		    user-select: none;
		    cursor: pointer;
		    box-shadow: 0px 0px 0px rgba(20%,20%,20%,0.0);
		    transition: all 0.1s;
		}
		.settingBtn:hover{
		    border: solid 2px;
		    box-shadow: 0px 0px 8px rgba(20%,20%,20%,0.5);
		}
		.settingBtn:active{
		    font-size: 17px;
		}
		.waterTable{
		    border: 0px solid #000000;
			background: #fff;
			height: 30px;
			font-size: 13px;
			color: #DDD;
			text-align: center;
		}
	</style>
	<script language=javascript>
		var _status = new Boolean(false);

        $(document).ready(function (){
			if(isMobile()){
				document.getElementById("showWaterLevel").width = "20%";
				console.log('This is Mobile')
			}else{
				document.getElementById("showWaterLevel").width = "50px";
				console.log('This is PC or else')
			}
        });

		function isMobile() {
			try{ document.createEvent("TouchEvent"); return true; }
			catch(e){ return false;}
		}

		function btnClick(CMD){
			var textTemp = document.getElementById('exeState').innerHTML;
			document.getElementById('exeState').innerHTML = textTemp + '執行中\n';
			sendCMD(CMD);
		}
		function sendCMD(CMD){
			var textTemp = document.getElementById('exeState').innerHTML;
		    var _xmlhttp;
		    _xmlhttp = new XMLHttpRequest();
		    _xmlhttp.onreadystatechange = function(){
		        if (_xmlhttp.readyState==4 && _xmlhttp.status==200){
		        	var _HTML = _xmlhttp.responseText;
					console.log(_HTML)
					_HTML = _HTML.split(' ');
					if( _HTML.length==1 ){
						_HTML[1] = _HTML[0];
					}
					console.log(_HTML[0])
		        	if( _HTML[0]=='OK' ){
		        		document.getElementById('exeState').innerHTML = textTemp + "回傳資料: " + _HTML[1] + '\n';	
		        	}else if( _HTML[0]=='ERR' ){
		        		document.getElementById('exeState').innerHTML = textTemp + "執行錯誤: " + _HTML[1] + '\n';	
		        	}else{
		        		document.getElementById('exeState').innerHTML = textTemp + "未知錯誤" + '\n';
		        	}
		        }
		    }
		    _xmlhttp.open("GET","/index?cmd=" + CMD, true);
		    _xmlhttp.send();
		}

		function reMap( x, in_min, in_max, out_min, out_max){
			var reMapValue = (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
			if( reMapValue < out_min ){
				reMapValue = out_min;
			}
			if( reMapValue > out_max ){
				reMapValue = out_max;
			}
			return reMapValue;
		}
	</script>
</head>
<body class="mainCSS">
<center>
	<div style="margin-top: 20px;">
		<table>
		<tr>
			<td>
				<table>
				<tr>
					<td><span style="margin-top:30px;">Device: 1</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn0" onclick="btnClick('@1*GotoHome')" class="settingBtn" style="margin-top:30px;">馬達回原點</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn1" onclick="btnClick('@1*GotoP1')" class="settingBtn" style="margin-top:30px;">馬達移動1</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn2" onclick="btnClick('@1*GotoP2')" class="settingBtn" style="margin-top:30px;">馬達移動2</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn3" onclick="btnClick('@1*GotoP3')" class="settingBtn" style="margin-top:30px;">馬達移動3</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn4" onclick="btnClick('@1*GotoP4')" class="settingBtn" style="margin-top:30px;">馬達移動4</span></td>
				</tr>
				</table>
			</td>
			<td>
				<table>
				<tr>
					<td><span style="margin-top:30px;">Device: 2</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn5" onclick="btnClick('@2*Water')" class="settingBtn" style="margin-top:30px;">啟動幫浦</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn6" onclick="btnClick('@2*CheckWaterLevel')" class="settingBtn" style="margin-top:30px;">確認儲水量</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn7" onclick="btnClick('@2*Temp')" class="settingBtn" style="margin-top:30px;">空氣溫度</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn8" onclick="btnClick('@2*Hum')" class="settingBtn" style="margin-top:30px;">空氣濕度</span></td>
				</tr>
				<tr>
					<td>　</td>
				</tr>
				</table>
			</td>
			<td>
				<table>
				<tr>
					<td><span style="margin-top:30px;">Device: 3</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn9" onclick="btnClick('@3*SoilHum1')" class="settingBtn" style="margin-top:30px;">土壤濕度1</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn10" onclick="btnClick('@3*SoilHum2')" class="settingBtn" style="margin-top:30px;">土壤濕度2</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn11" onclick="btnClick('@3*SoilHum3')" class="settingBtn" style="margin-top:30px;">土壤濕度3</span></td>
				</tr>
				<tr>
					<td><span id="settingBtn12" onclick="btnClick('@3*SoilHum4')" class="settingBtn" style="margin-top:30px;">土壤濕度4</span></td>
				</tr>
				<tr>
					<td>　</td>
				</tr>
				</table>
			</td>
		</tr>
		</table>
	</div>
	<div style="margin-top: 20px;">
		<table>
		<tr>
			<td>狀態: </td>
		</tr>
		<tr>
			<td><textarea id="exeState" style="width:300px;height:100px;"></textarea></td>
		</tr>
		</table>
	</div>
	
</center>
</body>
</html>